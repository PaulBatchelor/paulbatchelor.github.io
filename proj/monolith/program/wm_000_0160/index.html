<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="utf-8">
<link rel="stylesheet" href="/css/style.css">

</head>
<body>
<div id="main">

<h2>4. Global Data</h2>

<p><a id="wm_000_0160"></a></p>

<h3>4.1. typedef</h3>

<p><a id="wm_000_0161"></a>All things related to Monolith are contained in a struct
called <code>monolith_d</code>.
<div><b><i>&lt;&lt;typedefs&gt;&gt;=</i></b></div><pre><code>typedef struct monolith_d monolith_d;</pre></code>
<div><b><i>&lt;&lt;global_struct&gt;&gt;=</i></b></div><pre><code>struct monolith_d {
&lt;&lt;struct_contents&gt;&gt;
};</pre></code>

<h3>4.2. global variable</h3>

<p><a id="wm_000_0171"></a>A single instance of <code>monolith_d</code> is created as a global
variable. The global variable is denoted with the prefix "g_".
</p>
<div><b><i>&lt;&lt;global_struct&gt;&gt;=</i></b></div><pre><code>static monolith_d g_monolith;</pre></code>

<h3>4.3. getting global variable</h3>

<p><a id="wm_000_0175"></a>This global data can be acquired indirectly with the
function <code>monolith_data_get</code>.
</p>
<div><b><i>&lt;&lt;function_declarations&gt;&gt;=</i></b></div><pre><code>monolith_d* monolith_data_get(void);</pre></code>
<div><b><i>&lt;&lt;functions&gt;&gt;=</i></b></div><pre><code>monolith_d* monolith_data_get(void)
{
    return &g_monolith;
}</pre></code>
<p></p>
<p>This can be retrieved in Janet with <code>monolith/data</code>.
</p>
<div><b><i>&lt;&lt;core_janet_entries&gt;&gt;=</i></b></div><pre><code>{
"monolith/data",
j_data,
"Return global pointer to Monolith.\n"
},</pre></code>
<div><b><i>&lt;&lt;janet_functions&gt;&gt;=</i></b></div><pre><code>static Janet j_data(int32_t argc, Janet *argv)
{
    janet_fixarity(argc, 0);
    return janet_wrap_pointer(monolith_data_get());
}</pre></code>

<h3>4.4. data init</h3>

<p><a id="wm_000_0189"></a>The monolith data is initialized with the function
<code>monolith_init</code>.
</p>
<div><b><i>&lt;&lt;function_declarations&gt;&gt;=</i></b></div><pre><code>void monolith_init(monolith_d *m);</pre></code>
<div><b><i>&lt;&lt;functions&gt;&gt;=</i></b></div><pre><code>void monolith_init(monolith_d *m)
{
&lt;&lt;init&gt;&gt;
}</pre></code>

<h3>4.5. data cleanup</h3>

<p><a id="wm_000_0197"></a>All allocated data is cleaned with the program
<code>monolith_cleanup</code>.
</p>
<div><b><i>&lt;&lt;function_declarations&gt;&gt;=</i></b></div><pre><code>void monolith_cleanup(monolith_d *m);</pre></code>
<div><b><i>&lt;&lt;functions&gt;&gt;=</i></b></div><pre><code>void monolith_cleanup(monolith_d *m)
{
&lt;&lt;cleanup&gt;&gt;
}</pre></code>
<p></p>
<br>
<p><hr>

<a href="/proj/monolith/program/wm_000_0016">prev</a> | <a href="/proj/monolith/program/wm_000">home</a> | <a href="/proj/monolith/program/wm_000_0205">next</a></p>
</div>
</body>
</html>

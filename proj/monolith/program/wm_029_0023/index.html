<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="utf-8">
<link rel="stylesheet" href="/css/style.css">

</head>
<body>
<div id="main">

<h3>3. Node</h3>

<p><a id="wm_029_0023"></a>A new node is created with <code>node_ftlget</code>.
<div><b><i>&lt;&lt;funcdefs&gt;&gt;=</i></b></div><pre><code>int node_ftlget(pw_node *node, sp_ftlist *ftl);</pre></code>
<p></p>
<p>This node is setup so as to require no <code>destroy</code> callback.
</p>
<div><b><i>&lt;&lt;funcs&gt;&gt;=</i></b></div><pre><code>int node_ftlget(pw_node *node, sp_ftlist *ftl)
{
    pw_node_cables_alloc(node, 2);
    pw_node_set_block(node, 1);
    pw_node_set_compute(node, compute);
    pw_node_set_data(node, ftl);
    return PW_OK;
}</pre></code>
<div><b><i>&lt;&lt;static_funcdefs&gt;&gt;=</i></b></div><pre><code>static void compute(pw_node *node);</pre></code>
<div><b><i>&lt;&lt;funcs&gt;&gt;=</i></b></div><pre><code>static void compute(pw_node *node)
{
    int blksize;
    int n;
    sp_ftlist *ftl;
    pw_cable *in;
    pw_cable *out;

    blksize = pw_node_blksize(node);
    ftl = pw_node_get_data(node);

    pw_node_get_cable(node, 0, &in);
    pw_node_get_cable(node, 1, &out);

    for (n = 0; n &lt; blksize; n++) {
        int pos;
        sp_ftbl *t;
        PWFLT x;
        x = 0;
        pos = floor(pw_cable_get(in, n));
        t = sp_ftlist_target_sa(ftl, n);
        if (x &lt; t-&gt;size) x = t-&gt;tbl[pos];
        pw_cable_set(out, n, x);
    }
}</pre></code>
</div>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="utf-8">
<title>Initial Impressions using Org-Babel for Literate Programming</title>

<link rel="stylesheet" href="/css/style.css">

</head>
<body>
<div id="main">
<h1>Initial Impressions using Org-Babel for Literate Programming</h1>
<p>2018-09-21</p>
<p>I thought I'd break my year long radio static and talk about
my brief encounters writing a literate program inside of org-babel,
and compare it to my experiences working with CWEB.</p>
<p>For those who do not know,
<a href="https://orgmode.org/worg/org-contrib/babel/">org-babel</a>
is a system built on top <a href="https://orgmode.org/">org-mode</a>, which is built
on top of emacs.</p>
<p>Org-babel is an environment that is mainly designed to allow one to write and
execute code snippets inside of an org-mode document. Org-babel can also be
turned into a
<a href="https://en.wikipedia.org/wiki/Literate_programming">literate programming</a>
environment. It was this aspect that I wanted to explore.</p>
<p>For reference, I'm pretty new to emacs, org, and org-mode (about 8 months now).
Literate programming is something I have bit more experience in.
Over the past 2 years, I've written a handful of literate programs in C
using <a href="https://en.wikipedia.org/wiki/CWEB">CWEB</a>. A few of these are
open source.</p>
<p>CWEB and WEB are without a doubt the gold standards for what literate
programming environments should be like.</p>
<h2>The Program</h2>
<p>Unfortunately, this is something I cannot show because it's related
to work. I will say that the program was a small offline analysis
utility written in C with 274 significant lines of code.</p>
<h2>The goods</h2>
<h3>easy setup</h3>
<p>Org-mode is nice to learn because it is very well documented, and you do not
need to learn much to be productive. Org-babel was the exact same way, which
made things very nice.
I myself found most of what I needed on the
<a href="https://orgmode.org/worg/org-contrib/babel/intro.html">org-babel introductory page</a>
on the org-mode website.</p>
<p>Org-babel lives inside of org-mode, so it was easy to build on top of what I
already know.</p>
<h3>Great editor integration</h3>
<p>Because it basically extra features for org-mode, org-babel has some pretty
amazing editor integration inside of emacs. This meant I could use useful
org-mode tricks things like section folding, TODOs, hyperlinks, and lists.
In addition, syntax highlighting was enabled for the code blocks, which
made readability very nice. It was very warmly welcomed level of interactivity.</p>
<p>CWEB, on the other hand, has no fancy integrations or syntax highlighting,
which could make navigation a real drag on larger documents. I actually
had better luck looking at the rendered PDF most times (which I suppose
was the intent of CWEB in the first place, but still).</p>
<h3>very pretty HTML output</h3>
<p>Org-babel "weaves" documents into a number of different formats using
the the org-mode export features, HTML being one of the backends.
The HTML content includes codeblocks with syntax highlighting which
look really nice!</p>
<p>I really enjoyed being able to read documents using a web browser instead
of a PDF reader. It felt nicer, but that's no surprise since HTML content
is optimized to be read on a screen, while TeX generated PDF content
is optimized to read on printed paper.</p>
<h3>Github Integration</h3>
<p>Github has support for reading org-mode files. It was super cool to be able
to send my coworkers links to my org file and have them see the HTML output
without needing to install anything.</p>
<h2>The Bads</h2>
<h3>ugly syntax</h3>
<p>Let's be clear,
<a href="https://karl-voit.at/2017/09/23/orgmode-as-markup-only/">org syntax is simple and clear</a>.
What I'm referring to are the clunky extension codes jammed for the org-babel
functionality.</p>
<p>This is the most minimal way you can make a named codeblock in org-babel</p>
<pre><code> #+NAME: hello_world
 #+BEGIN_SRC c
 #include &lt;stdio.h&gt;</code></pre>
<pre><code> int main(int argc, char *argv[])
 {
     printf(&quot;Hello world\n&quot;);
     return 0;
 }
 #+END_SRC</code></pre>
<p>By comparison, here is how you'd do it in CWEB:</p>
<pre><code> @&lt;hello_world@&gt;=
 #include &lt;stdio.h&gt;</code></pre>
<pre><code> int main(int argc, char *argv[])
 {
     printf(&quot;Hello world\n&quot;);
     return 0;
 }</code></pre>
<p>You see how much better that is? Way less typing required CWEB, and the
syntax is more visual.</p>
<p>With org-babel, I learned that you can actually get emacs to type some
template code for you by typing "<s" and hitting TAB. This saves some
keystrokes, but it's still ugly.</p>
<h3>No debugging line numbers</h3>
<p>Org-tangle doesn't seem to have any way to insert
<a href="https://gcc.gnu.org/onlinedocs/cpp/Line-Control.html#Line-Control">line directives</a>
inside of tangled C code. This makes debugging a generated programming
very painful. Instead of the compiler telling you the line number of
the code block in the org-mode file, it tells you the line number of generated
code. That means opening up the C code to find the line in question, then
somehow tracing it to whereever it is on the org-mode file. Really frustrating.</p>
<h3>Slow Tangling</h3>
<p>This one is the dealbreaker for me. Generating code with org-tangle is
unbearably slow. It took a good 10 seconds to generate my tiny ~300 line
program. This seemed to get noticeably slower as my program grew. Delays like
this made adjustments quite tedious.</p>
<h2>Conclusion</h2>
<p>Org-mode has great potential for being a great tool for literate
programming, even with some of the clunky syntax. As it stands now,
org-babel is too inefficient to be useful for anything more than generating
small scripts.</p>
<p>I'm still enthusiastic about the idea of using org-mode for building
literate programs in C, and may build some handrolled parsers for faster
execution.</p>

</div>
</body>
</html>

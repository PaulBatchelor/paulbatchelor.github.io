<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
	<meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
	<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1' />
    <title>Paul Batchelor : 9 ways to NRT, part 6: Generative techniques with NRT and Csound</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="This is the homepage of Paul Batchelor">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">
	<link rel="stylesheet" href="/css/menu.css">

</head>


    <body>

    <header class="site-header">
<div id='cssmenu'>
<ul>
   <li><a href="/">
   <span>Home</span></a></li>
   <li><a href="/about">
   <span>About</span></a></li>
   <li><a href="/portfolio">
   <span>Portfolio</span></a></li>
   <li><a href="/blog">
   <span>Blog</span></a></li>
   <li><a href="/contact">
   <span>Contact</span></a></li>
</ul>
</div>
</header>


    <div class="page-content">
      <div class="wrap">
        <header class="post-header">
    <h1>9 ways to NRT, part 6: Generative techniques with NRT and Csound</h1>
    <p class="meta">Jan 11, 2015</p>
  </header>

  <article class="post-content">
  <p>Welcome to Part 6 of <a href="/nrt/2014/12/19/nrt-syntax/">9 Ways to NRT</a>!</p>

<p>At this point, I’ve gone through many ways to translate NRT notation
into useful formats, but I haven’t yet shown how NRT can be used as composition 
tool for algorithmic and generative music. Today I wanted to write a simple 
generative music program using NRT and Csound. </p>

<p>The file below is a relatively simple pluck instrument I designed. Since we will
be generating a corresponding score file, I’ve decided to do away with the 
monolithic format of the CSD and just use an oldschool .orc file. Save this file
as <em>plucker.orc</em>:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">sr</span>	<span class="o">=</span>	96000
<span class="nv">ksmps</span>	<span class="o">=</span>	1
<span class="nv">nchnls</span>	<span class="o">=</span>	2
<span class="nv">0dbfs</span>	<span class="o">=</span>	1

instr 1	
<span class="nv">icps</span> <span class="o">=</span> cpsmidinn<span class="o">(</span>p4<span class="o">)</span>
<span class="p">;</span>random amplitude
<span class="nv">iamp</span> <span class="o">=</span> random<span class="o">(</span>0.2, 0.25<span class="o">)</span>
<span class="p">;</span>a pluck using a saw
a1 pluck iamp, icps, icps, ftgenonce<span class="o">(</span>0, 0, 4096, 7, 1, 4096, -1<span class="o">)</span>, 1 
a1 *<span class="o">=</span> linsegr<span class="o">(</span>1, 1, 0<span class="o">)</span>
<span class="p">;</span>scoop out the low end
<span class="nv">a1</span> <span class="o">=</span> buthp<span class="o">(</span>a1, 300<span class="o">)</span>
outs a1, a1
endin</code></pre></div>

<p>Now for the note generation. I’m using a mixture of awk and bash for my needs. The
algorithm creates some nrt code by randomly stringing together smaller fragments
of prewritten phrases in NRT. This code then gets sent to AWK where it is turned
into a Csound score. The Csound score is then read and compiled to a wav file. </p>

<div class="highlight"><pre><code class="bash"><span class="c">#!/bin/bash</span>
<span class="nv">tempo</span><span class="o">=</span>120 

<span class="c">#collection of NRT fragments</span>
<span class="nv">cluster</span><span class="o">=(</span>
    d4rm
    m4.f8s4
    t8Ds2. 
    m4rd
<span class="o">)</span><span class="p">;</span>

<span class="c">#randomly string NRT fragments, and generate score</span>
<span class="k">for </span>i in <span class="k">$(</span>seq 1 4<span class="k">)</span>
<span class="k">do </span>
<span class="k">   </span><span class="nv">nrt</span><span class="o">=</span><span class="nv">$nrt</span><span class="k">${</span><span class="nv">cluster</span><span class="p">[</span><span class="nv">$RANDOM</span><span class="p"> % 4]</span><span class="k">}</span> 
<span class="k">done</span>

<span class="nb">echo</span> <span class="nv">$nrt</span> <span class="p">|</span> nrt -F <span class="s1">&#39; &#39;</span> <span class="p">|</span><span class="se">\</span>
awk -vtempo<span class="o">=</span><span class="nv">$tempo</span> <span class="s1">&#39;</span>
<span class="s1">BEGIN{</span>
<span class="s1">ts = 60 / tempo</span>
<span class="s1">max = 0</span>
<span class="s1">}</span>
<span class="s1">{</span>
<span class="s1">    print &quot;i1&quot;,$1 * ts,$2 * ts,$3 + 60;</span>
<span class="s1">    if($1 * ts + $2 * ts &gt; max) {</span>
<span class="s1">        max = $1 * ts + $2 * ts</span>
<span class="s1">    }</span>
<span class="s1">}</span>
<span class="s1">&#39;</span> &gt; score.sco

<span class="c">#render wav file</span>
csound -o out.wav plucker.orc score.sco
rm score.sco</code></pre></div>

<p>When this code is run, it creates a file called “out.wav”, which can sound
something like <a href="/res/nineways/csound_nrt.wav">this</a></p>

  </article>

      </div>
    </div>

    <div class = "site-footer">

    Copyright 2014 Paul Batchelor

</div>


    </body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="/css/style.css">

</head>
<body>
<div id="main">

<h3>2. The main program</h3>

<p><a id="wm_013_0013"></a>The main program is contained in a function called
<code>get_main</code>, taking in <code>argc</code> and <code>argv</code> parameters.
<div><b><i>&lt;&lt;function_declarations&gt;&gt;=</i></b></div><pre><code>int p_get(int argc, char *argv[]);</pre></code>
<div><b><i>&lt;&lt;functions&gt;&gt;=</i></b></div><pre><code>int p_get(int argc, char *argv[])
{
    int len;
    if(argc &lt; 2) {
        print_help();
        return 1;
    }
    len = strlen(argv[1]);
    if(0) {
        /* starts the chain */
    }
&lt;&lt;command_parsing&gt;&gt;
    else {
        fprintf(stderr,
                "Could not find subcommand '%s'\n",
                argv[1]);
        return 1;
    }
    return 0;
}</pre></code>

<h4>2.1. Print Help</h4>

<p><a id="wm_013_0023"></a>Prints all available commands if there are not enough
arguments provided.
<div><b><i>&lt;&lt;function_declarations&gt;&gt;=</i></b></div><pre><code>static void print_help(void);</pre></code>
<div><b><i>&lt;&lt;functions&gt;&gt;=</i></b></div><pre><code>static void print_help(void)
{
    fprintf(stderr, "Available Commands\n\n");
&lt;&lt;available_commands&gt;&gt;
}</pre></code>

<h4>2.2. Matching</h4>

<p><a id="wm_013_0031"></a>It's not enough to use <code>strncmp</code> with this program, because
then <code>file</code> and <code>filelist</code> will be treated as the same.
String length of the input string must be taken into
account.
</p>
<p>The static function <code>match</code> is an abstraction around this.
</p>
<div><b><i>&lt;&lt;function_declarations&gt;&gt;=</i></b></div><pre><code>static int match(const char *s1,
                 int sz1,
                 const char *s2,
                 int sz2);</pre></code>
<div><b><i>&lt;&lt;functions&gt;&gt;=</i></b></div><pre><code>static int match(const char *s1,
                 int sz1,
                 const char *s2,
                 int sz2)
{
    return sz1 == sz2 && !strncmp(s1, s2, sz2);
}</pre></code>
<p></p>
<br>
<p><hr>

<a href="/loom/wm_013_0002">prev</a> | <a href="/loom/worgmap_get">home</a> | <a href="/loom/wm_013_0037">next</a></p>
</div>
</body>
</html>
